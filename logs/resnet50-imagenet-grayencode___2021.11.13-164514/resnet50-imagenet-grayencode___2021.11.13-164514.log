2021-11-13 16:45:14,282 - Log file for this run: /home/th.nguyen/drift-encode/logs/resnet50-imagenet-grayencode___2021.11.13-164514/resnet50-imagenet-grayencode___2021.11.13-164514.log
2021-11-13 16:45:14,283 - Number of CPUs: 56
2021-11-13 16:45:14,424 - Number of GPUs: 6
2021-11-13 16:45:14,424 - CUDA version: 10.0.130
2021-11-13 16:45:14,425 - CUDNN version: 7603
2021-11-13 16:45:14,425 - Kernel: 5.4.0-86-generic
2021-11-13 16:45:14,425 - Python: 3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
[GCC 7.5.0]
2021-11-13 16:45:14,425 - pip freeze: {'absl-py': '0.12.0', 'aiohttp': '3.7.4.post0', 'argon2-cffi': '21.1.0', 'astor': '0.8.1', 'astunparse': '1.6.3', 'async-generator': '1.10', 'async-timeout': '3.0.1', 'atomicwrites': '1.4.0', 'attrs': '21.2.0', 'backcall': '0.2.0', 'black': '21.9b0', 'bleach': '4.1.0', 'blessed': '1.19.0', 'blessings': '1.7', 'blinker': '1.4', 'bqplot': '0.11.5', 'brotlipy': '0.7.0', 'cachetools': '4.2.2', 'certifi': '2020.12.5', 'cffi': '1.14.6', 'chardet': '4.0.0', 'charset-normalizer': '2.0.4', 'click': '8.0.1', 'coverage': '5.5', 'cryptography': '3.4.7', 'cycler': '0.10.0', 'cython': '0.29.24', 'dataclasses': '0.8', 'decorator': '5.1.0', 'defusedxml': '0.7.1', 'distiller': '0.4.0rc0', 'entrypoints': '0.3', 'gast': '0.2.2', 'gitdb': '4.0.9', 'gitdb2': '3.0.3.post1', 'gitpython': '3.1.0', 'google-auth': '1.30.1', 'google-auth-oauthlib': '0.4.4', 'google-pasta': '0.2.0', 'gpustat': '1.0.0.dev1', 'graphviz': '0.10.1', 'grpcio': '1.38.0', 'gym': '0.12.5', 'h5py': '2.10.0', 'idna': '2.10', 'idna-ssl': '1.1.0', 'importlib-metadata': '4.8.1', 'ipykernel': '5.5.6', 'ipython': '7.16.1', 'ipython-genutils': '0.2.0', 'ipywidgets': '7.4.2', 'jedi': '0.17.2', 'jinja2': '3.0.2', 'joblib': '1.1.0', 'jsonpatch': '1.32', 'jsonpointer': '2.1', 'jsonschema': '3.2.0', 'jupyter': '1.0.0', 'jupyter-client': '7.0.6', 'jupyter-console': '6.4.0', 'jupyter-core': '4.8.1', 'jupyterlab-pygments': '0.1.2', 'keras-applications': '1.0.8', 'keras-preprocessing': '1.1.2', 'kiwisolver': '1.3.1', 'markdown': '3.3.4', 'markupsafe': '2.0.1', 'matplotlib': '3.3.4', 'mistune': '0.8.4', 'mkl-fft': '1.3.0', 'mkl-random': '1.1.1', 'mkl-service': '2.3.0', 'more-itertools': '8.10.0', 'multidict': '5.1.0', 'munch': '2.5.0', 'mypy-extensions': '0.4.3', 'nbclient': '0.5.4', 'nbconvert': '6.0.7', 'nbformat': '5.1.3', 'nest-asyncio': '1.5.1', 'notebook': '6.4.4', 'numpy': '1.18.5', 'nvidia-ml-py3': '7.352.0', 'oauthlib': '3.1.0', 'olefile': '0.46', 'opt-einsum': '3.3.0', 'packaging': '21.0', 'pandas': '1.1.5', 'pandocfilters': '1.5.0', 'parse': '1.19.0', 'parso': '0.7.1', 'pathspec': '0.9.0', 'pexpect': '4.8.0', 'pickle5': '0.0.11', 'pickleshare': '0.7.5', 'pillow': '6.2.2', 'pip': '21.2.2', 'platformdirs': '2.4.0', 'pluggy': '0.13.1', 'pretrainedmodels': '0.7.4', 'prometheus-client': '0.11.0', 'prompt-toolkit': '3.0.20', 'protobuf': '3.17.1', 'psutil': '5.8.0', 'ptyprocess': '0.7.0', 'py': '1.10.0', 'pyasn1': '0.4.8', 'pyasn1-modules': '0.2.8', 'pycparser': '2.20', 'pydot': '1.4.1', 'pyglet': '1.5.21', 'pygments': '2.10.0', 'pyjwt': '2.1.0', 'pyopenssl': '20.0.1', 'pyparsing': '2.4.7', 'pyrsistent': '0.18.0', 'pysocks': '1.7.1', 'pytest': '4.6.11', 'python-dateutil': '2.8.2', 'python-jsonrpc-server': '0.4.0', 'python-language-server': '0.36.2', 'pytz': '2021.3', 'pyyaml': '6.0', 'pyzmq': '22.3.0', 'qgrid': '1.1.1', 'qtconsole': '5.1.1', 'qtpy': '1.11.2', 'ranger-fm': '1.9.3', 'regex': '2021.10.21', 'requests': '2.25.1', 'requests-oauthlib': '1.3.0', 'rsa': '4.7.2', 'scikit-learn': '0.21.2', 'scipy': '1.5.4', 'seaborn': '0.11.2', 'send2trash': '1.8.0', 'setuptools': '57.0.0', 'six': '1.16.0', 'smmap': '4.0.0', 'smmap2': '2.0.5', 'tabulate': '0.8.3', 'tensorboard': '1.15.0', 'tensorboard-data-server': '0.6.1', 'tensorboard-plugin-wit': '1.8.0', 'tensorflow': '1.15.0', 'tensorflow-estimator': '1.15.1', 'termcolor': '1.1.0', 'terminado': '0.12.1', 'testpath': '0.5.0', 'timm': '0.4.9', 'tomli': '1.2.1', 'torch': '1.3.1', 'torchfile': '0.1.0', 'torchnet': '0.0.4', 'torchsummary': '1.5.1', 'torchvision': '0.4.2', 'tornado': '6.1', 'tqdm': '4.33.0', 'traitlets': '4.3.3', 'traittypes': '0.2.1', 'typed-ast': '1.4.3', 'typing-extensions': '3.10.0.1', 'ujson': '4.1.0', 'urllib3': '1.26.4', 'visdom': '0.1.8.9', 'wcwidth': '0.2.5', 'webencodings': '0.5.1', 'websocket-client': '1.2.1', 'werkzeug': '2.0.1', 'wheel': '0.36.2', 'widgetsnbextension': '3.4.2', 'wrapt': '1.12.1', 'xlsxwriter': '3.0.1', 'yarl': '1.6.3', 'zipp': '3.5.0'}
2021-11-13 16:45:14,521 - Git is dirty
2021-11-13 16:45:14,522 - Active Git branch: master
2021-11-13 16:45:14,572 - Git commit: f401db9403c1608e10258733e013b6c087e3ef34
2021-11-13 16:45:14,573 - Command line: compress_classifier.py --arch resnet50 -p 10 -j 22 /home/imagenet/ --pretrained --run --qe-config-file ./resnet18_imagenet_post_train.yaml --gpus 2 --name resnet50-imagenet-grayencode --method proposed_method --mlc 8 --num_bits 8
2021-11-13 16:45:14,573 - Distiller: 0.4.0rc0
2021-11-13 16:45:14,576 - Random seed: 67693
2021-11-13 16:45:15,317 - => created a pretrained resnet50 model with the imagenet dataset
2021-11-13 16:45:17,826 - Optimizer Type: <class 'torch.optim.sgd.SGD'>
2021-11-13 16:45:17,828 - Optimizer Args: {'lr': 0.1, 'momentum': 0.9, 'dampening': 0, 'weight_decay': 0.0001, 'nesterov': False}
2021-11-13 16:45:18,100 - Dataset sizes:
	test=50000
2021-11-13 16:45:18,101 - Reading configuration from: ./resnet18_imagenet_post_train.yaml
2021-11-13 16:45:18,111 - Found component of class PostTrainLinearQuantizer: Name: post_train_quantizer ; Section: quantizers
2021-11-13 16:45:18,112 - Loading activation stats from: ./quant_stats/resnet50-imagenet.yaml
2021-11-13 16:45:18,486 - Preparing model for quantization using PostTrainLinearQuantizer
2021-11-13 16:45:21,101 - Applying batch-norm folding ahead of post-training quantization
2021-11-13 16:45:21,102 - Fusing sequence ['module.conv1', 'module.bn1']
2021-11-13 16:45:21,103 - Fusing sequence ['module.layer1.0.conv1', 'module.layer1.0.bn1']
2021-11-13 16:45:21,104 - Fusing sequence ['module.layer1.0.conv2', 'module.layer1.0.bn2']
2021-11-13 16:45:21,104 - Fusing sequence ['module.layer1.0.conv3', 'module.layer1.0.bn3']
2021-11-13 16:45:21,104 - Fusing sequence ['module.layer1.0.downsample.0', 'module.layer1.0.downsample.1']
2021-11-13 16:45:21,105 - Fusing sequence ['module.layer1.1.conv1', 'module.layer1.1.bn1']
2021-11-13 16:45:21,105 - Fusing sequence ['module.layer1.1.conv2', 'module.layer1.1.bn2']
2021-11-13 16:45:21,105 - Fusing sequence ['module.layer1.1.conv3', 'module.layer1.1.bn3']
2021-11-13 16:45:21,106 - Fusing sequence ['module.layer1.2.conv1', 'module.layer1.2.bn1']
2021-11-13 16:45:21,106 - Fusing sequence ['module.layer1.2.conv2', 'module.layer1.2.bn2']
2021-11-13 16:45:21,106 - Fusing sequence ['module.layer1.2.conv3', 'module.layer1.2.bn3']
2021-11-13 16:45:21,107 - Fusing sequence ['module.layer2.0.conv1', 'module.layer2.0.bn1']
2021-11-13 16:45:21,107 - Fusing sequence ['module.layer2.0.conv2', 'module.layer2.0.bn2']
2021-11-13 16:45:21,107 - Fusing sequence ['module.layer2.0.conv3', 'module.layer2.0.bn3']
2021-11-13 16:45:21,108 - Fusing sequence ['module.layer2.0.downsample.0', 'module.layer2.0.downsample.1']
2021-11-13 16:45:21,108 - Fusing sequence ['module.layer2.1.conv1', 'module.layer2.1.bn1']
2021-11-13 16:45:21,108 - Fusing sequence ['module.layer2.1.conv2', 'module.layer2.1.bn2']
2021-11-13 16:45:21,109 - Fusing sequence ['module.layer2.1.conv3', 'module.layer2.1.bn3']
2021-11-13 16:45:21,109 - Fusing sequence ['module.layer2.2.conv1', 'module.layer2.2.bn1']
2021-11-13 16:45:21,109 - Fusing sequence ['module.layer2.2.conv2', 'module.layer2.2.bn2']
2021-11-13 16:45:21,110 - Fusing sequence ['module.layer2.2.conv3', 'module.layer2.2.bn3']
2021-11-13 16:45:21,110 - Fusing sequence ['module.layer2.3.conv1', 'module.layer2.3.bn1']
2021-11-13 16:45:21,110 - Fusing sequence ['module.layer2.3.conv2', 'module.layer2.3.bn2']
2021-11-13 16:45:21,111 - Fusing sequence ['module.layer2.3.conv3', 'module.layer2.3.bn3']
2021-11-13 16:45:21,111 - Fusing sequence ['module.layer3.0.conv1', 'module.layer3.0.bn1']
2021-11-13 16:45:21,111 - Fusing sequence ['module.layer3.0.conv2', 'module.layer3.0.bn2']
2021-11-13 16:45:21,112 - Fusing sequence ['module.layer3.0.conv3', 'module.layer3.0.bn3']
2021-11-13 16:45:21,112 - Fusing sequence ['module.layer3.0.downsample.0', 'module.layer3.0.downsample.1']
2021-11-13 16:45:21,112 - Fusing sequence ['module.layer3.1.conv1', 'module.layer3.1.bn1']
2021-11-13 16:45:21,113 - Fusing sequence ['module.layer3.1.conv2', 'module.layer3.1.bn2']
2021-11-13 16:45:21,113 - Fusing sequence ['module.layer3.1.conv3', 'module.layer3.1.bn3']
2021-11-13 16:45:21,113 - Fusing sequence ['module.layer3.2.conv1', 'module.layer3.2.bn1']
2021-11-13 16:45:21,114 - Fusing sequence ['module.layer3.2.conv2', 'module.layer3.2.bn2']
2021-11-13 16:45:21,114 - Fusing sequence ['module.layer3.2.conv3', 'module.layer3.2.bn3']
2021-11-13 16:45:21,115 - Fusing sequence ['module.layer3.3.conv1', 'module.layer3.3.bn1']
2021-11-13 16:45:21,115 - Fusing sequence ['module.layer3.3.conv2', 'module.layer3.3.bn2']
2021-11-13 16:45:21,115 - Fusing sequence ['module.layer3.3.conv3', 'module.layer3.3.bn3']
2021-11-13 16:45:21,116 - Fusing sequence ['module.layer3.4.conv1', 'module.layer3.4.bn1']
2021-11-13 16:45:21,116 - Fusing sequence ['module.layer3.4.conv2', 'module.layer3.4.bn2']
2021-11-13 16:45:21,116 - Fusing sequence ['module.layer3.4.conv3', 'module.layer3.4.bn3']
2021-11-13 16:45:21,117 - Fusing sequence ['module.layer3.5.conv1', 'module.layer3.5.bn1']
2021-11-13 16:45:21,117 - Fusing sequence ['module.layer3.5.conv2', 'module.layer3.5.bn2']
2021-11-13 16:45:21,117 - Fusing sequence ['module.layer3.5.conv3', 'module.layer3.5.bn3']
2021-11-13 16:45:21,118 - Fusing sequence ['module.layer4.0.conv1', 'module.layer4.0.bn1']
2021-11-13 16:45:21,118 - Fusing sequence ['module.layer4.0.conv2', 'module.layer4.0.bn2']
2021-11-13 16:45:21,118 - Fusing sequence ['module.layer4.0.conv3', 'module.layer4.0.bn3']
2021-11-13 16:45:21,119 - Fusing sequence ['module.layer4.0.downsample.0', 'module.layer4.0.downsample.1']
2021-11-13 16:45:21,119 - Fusing sequence ['module.layer4.1.conv1', 'module.layer4.1.bn1']
2021-11-13 16:45:21,119 - Fusing sequence ['module.layer4.1.conv2', 'module.layer4.1.bn2']
2021-11-13 16:45:21,120 - Fusing sequence ['module.layer4.1.conv3', 'module.layer4.1.bn3']
2021-11-13 16:45:21,120 - Fusing sequence ['module.layer4.2.conv1', 'module.layer4.2.bn1']
2021-11-13 16:45:21,120 - Fusing sequence ['module.layer4.2.conv2', 'module.layer4.2.bn2']
2021-11-13 16:45:21,121 - Fusing sequence ['module.layer4.2.conv3', 'module.layer4.2.bn3']
2021-11-13 16:45:22,053 - Propagating output statistics from BN modules to folded modules
2021-11-13 16:45:22,054 -   bn1 --> module.conv1
2021-11-13 16:45:22,054 -   layer1.0.bn1 --> module.layer1.0.conv1
2021-11-13 16:45:22,054 -   layer1.0.bn2 --> module.layer1.0.conv2
2021-11-13 16:45:22,054 -   layer1.0.bn3 --> module.layer1.0.conv3
2021-11-13 16:45:22,054 -   layer1.0.downsample.1 --> module.layer1.0.downsample.0
2021-11-13 16:45:22,054 -   layer1.1.bn1 --> module.layer1.1.conv1
2021-11-13 16:45:22,054 -   layer1.1.bn2 --> module.layer1.1.conv2
2021-11-13 16:45:22,054 -   layer1.1.bn3 --> module.layer1.1.conv3
2021-11-13 16:45:22,054 -   layer1.2.bn1 --> module.layer1.2.conv1
2021-11-13 16:45:22,054 -   layer1.2.bn2 --> module.layer1.2.conv2
2021-11-13 16:45:22,054 -   layer1.2.bn3 --> module.layer1.2.conv3
2021-11-13 16:45:22,054 -   layer2.0.bn1 --> module.layer2.0.conv1
2021-11-13 16:45:22,054 -   layer2.0.bn2 --> module.layer2.0.conv2
2021-11-13 16:45:22,054 -   layer2.0.bn3 --> module.layer2.0.conv3
2021-11-13 16:45:22,054 -   layer2.0.downsample.1 --> module.layer2.0.downsample.0
2021-11-13 16:45:22,055 -   layer2.1.bn1 --> module.layer2.1.conv1
2021-11-13 16:45:22,055 -   layer2.1.bn2 --> module.layer2.1.conv2
2021-11-13 16:45:22,055 -   layer2.1.bn3 --> module.layer2.1.conv3
2021-11-13 16:45:22,055 -   layer2.2.bn1 --> module.layer2.2.conv1
2021-11-13 16:45:22,055 -   layer2.2.bn2 --> module.layer2.2.conv2
2021-11-13 16:45:22,055 -   layer2.2.bn3 --> module.layer2.2.conv3
2021-11-13 16:45:22,055 -   layer2.3.bn1 --> module.layer2.3.conv1
2021-11-13 16:45:22,055 -   layer2.3.bn2 --> module.layer2.3.conv2
2021-11-13 16:45:22,055 -   layer2.3.bn3 --> module.layer2.3.conv3
2021-11-13 16:45:22,055 -   layer3.0.bn1 --> module.layer3.0.conv1
2021-11-13 16:45:22,055 -   layer3.0.bn2 --> module.layer3.0.conv2
2021-11-13 16:45:22,055 -   layer3.0.bn3 --> module.layer3.0.conv3
2021-11-13 16:45:22,055 -   layer3.0.downsample.1 --> module.layer3.0.downsample.0
2021-11-13 16:45:22,055 -   layer3.1.bn1 --> module.layer3.1.conv1
2021-11-13 16:45:22,055 -   layer3.1.bn2 --> module.layer3.1.conv2
2021-11-13 16:45:22,055 -   layer3.1.bn3 --> module.layer3.1.conv3
2021-11-13 16:45:22,055 -   layer3.2.bn1 --> module.layer3.2.conv1
2021-11-13 16:45:22,055 -   layer3.2.bn2 --> module.layer3.2.conv2
2021-11-13 16:45:22,055 -   layer3.2.bn3 --> module.layer3.2.conv3
2021-11-13 16:45:22,055 -   layer3.3.bn1 --> module.layer3.3.conv1
2021-11-13 16:45:22,055 -   layer3.3.bn2 --> module.layer3.3.conv2
2021-11-13 16:45:22,055 -   layer3.3.bn3 --> module.layer3.3.conv3
2021-11-13 16:45:22,056 -   layer3.4.bn1 --> module.layer3.4.conv1
2021-11-13 16:45:22,056 -   layer3.4.bn2 --> module.layer3.4.conv2
2021-11-13 16:45:22,056 -   layer3.4.bn3 --> module.layer3.4.conv3
2021-11-13 16:45:22,056 -   layer3.5.bn1 --> module.layer3.5.conv1
2021-11-13 16:45:22,056 -   layer3.5.bn2 --> module.layer3.5.conv2
2021-11-13 16:45:22,056 -   layer3.5.bn3 --> module.layer3.5.conv3
2021-11-13 16:45:22,056 -   layer4.0.bn1 --> module.layer4.0.conv1
2021-11-13 16:45:22,056 -   layer4.0.bn2 --> module.layer4.0.conv2
2021-11-13 16:45:22,056 -   layer4.0.bn3 --> module.layer4.0.conv3
2021-11-13 16:45:22,056 -   layer4.0.downsample.1 --> module.layer4.0.downsample.0
2021-11-13 16:45:22,056 -   layer4.1.bn1 --> module.layer4.1.conv1
2021-11-13 16:45:22,056 -   layer4.1.bn2 --> module.layer4.1.conv2
2021-11-13 16:45:22,056 -   layer4.1.bn3 --> module.layer4.1.conv3
2021-11-13 16:45:22,056 -   layer4.2.bn1 --> module.layer4.2.conv1
2021-11-13 16:45:22,056 -   layer4.2.bn2 --> module.layer4.2.conv2
2021-11-13 16:45:22,056 -   layer4.2.bn3 --> module.layer4.2.conv3
2021-11-13 16:45:22,056 - Optimizing output statistics for modules followed by ReLU/Tanh/Sigmoid
2021-11-13 16:45:22,057 -   Module conv1 followed by Relu, updating stats
2021-11-13 16:45:22,057 -   Module layer1.0.conv1 followed by Relu, updating stats
2021-11-13 16:45:22,058 - Traceback (most recent call last):
  File "compress_classifier.py", line 325, in <module>
    main()
  File "compress_classifier.py", line 89, in main
    if app.handle_subapps():
  File "compress_classifier.py", line 321, in handle_subapps
    self.compression_scheduler, self.pylogger, self.args)
  File "compress_classifier.py", line 213, in handle_subapps
    quantizer.prepare_model(dummy_input)
  File "/home/th.nguyen/distiller/distiller/quantization/range_linear.py", line 1982, in prepare_model
    super(PostTrainLinearQuantizer, self).prepare_model(dummy_input)
  File "/home/th.nguyen/distiller/distiller/quantization/quantizer.py", line 239, in prepare_model
    self._pre_prepare_model(dummy_input)
  File "/home/th.nguyen/distiller/distiller/quantization/range_linear.py", line 1990, in _pre_prepare_model
    self._apply_activation_stats_fusions()
  File "/home/th.nguyen/distiller/distiller/quantization/range_linear.py", line 2073, in _apply_activation_stats_fusions
    m_stats = model_stats[n]
KeyError: 'layer1.0.relu1'

2021-11-13 16:45:22,058 - 
2021-11-13 16:45:22,058 - Log file for this run: /home/th.nguyen/drift-encode/logs/resnet50-imagenet-grayencode___2021.11.13-164514/resnet50-imagenet-grayencode___2021.11.13-164514.log
